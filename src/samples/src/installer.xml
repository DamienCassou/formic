<?xml version="1.0" encoding="UTF-8"?>
<!--
 Author: Eric Van Dewoestine
-->

<!--
  - Sample installer build file that is executed upon installation.
  -->
<project xmlns:formic="antlib:org.formic.ant"
    name="mock_installer" default="installer">

  <!--
    - Standard target to install the app.
    - Note: Must be named "installer".
    -->
  <target name="installer">
    <formic:installer property="install.complete"
        resources="resources.install" steps="resources.steps">
      <!-- main path -->
      <formic:path name="main">
        <formic:step name="welcome"/>

        <formic:step name="license"/>

        <!--formic:step name="test"/-->

        <formic:step name="installLocation">
          <property name="discoverer" value="TestDiscoverer"/>
        </formic:step>

        <!-- Go to branch 1 if branch == "branch" -->
        <formic:branch path="branch1">
          <equals arg1="${branch}" arg2="branch"/>
        </formic:branch>

        <!-- Go to branch 2 if branch != "branch" -->
        <formic:branch path="branch2">
          <not>
            <equals arg1="${branch}" arg2="branch"/>
          </not>
        </formic:branch>

        <formic:step name="featureList">
          <property name="features.xml" value="/resources/features.xml"/>
        </formic:step>

        <formic:step name="summary"/>
        <formic:step name="install"/>
        <formic:step name="finished"/>
      </formic:path>

      <!-- first possible branch -->
      <formic:path name="branch1">
        <formic:step name="license1"/>
      </formic:path>

      <!-- second possible branch -->
      <formic:path name="branch2">
        <formic:step name="license2"/>
      </formic:path>

    </formic:installer>
  </target>

  <!--
    - Task that will run at the end of the wizard process to perform user
    - defined task after gathering info from the user via the wizard.
    - Note: Must be named "install".
    -->
  <target name="install">
    <echo>Start ...</echo>
    <sleep seconds="1"/>
    <echo>${installLocation.location}</echo>
    <antcall target="install.child"/>
    <echo>5 ...</echo>
    <sleep seconds="1"/>
    <echo>6 ...</echo>
    <sleep seconds="1"/>
    <echo>Install Finished.</echo>
  </target>

  <!--
    - Shows support for child targets.
    - Target name can be any name that ant supports.
    -->
  <target name="install.child">
    <sleep seconds="1"/>
    <echo>2 ...</echo>
    <sleep seconds="1"/>
    <echo>3 ...</echo>
    <sleep seconds="1"/>
    <echo>4 ...</echo>
    <sleep seconds="1"/>
  </target>

  <!--
    - Task that will run if the wizard was canceled, where any necessary
    - cleanup can occur.
    - Note: Must be named "canceled".
    -->
  <target name="canceled">
    <echo>Installation canceled.</echo>
  </target>

</project>
